!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function n(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}(self.webpackChunkchat_app=self.webpackChunkchat_app||[]).push([[266],{3446:function(e,o,i){"use strict";i.r(o),i.d(o,{HomeModule:function(){return dt}});var a=i(9436),s=i(8583),c=i(9763),r=i(5072),u=i(5319),l=i(8002),m=i(9643),d=i(3342),g=i(7716),p=i(6673),h=i(6284),v=i(3017),f=i(4872),b=i(7556),Z=i(2325),A=i(2522),w=i(3738),y=i(1095),T=i(1436),C=i(6627),S=i(7701);function _(t,e){if(1&t&&(g.TgZ(0,"button",3),g.NdJ("click",function(){return e.$implicit.action()}),g.TgZ(1,"mat-icon"),g._uU(2),g.qZA(),g.qZA()),2&t){var n=e.$implicit;g.Q6J("matTooltip",n.tooltip),g.xp6(2),g.Oqu(n.icon)}}function R(t,e){if(1&t&&(g.TgZ(0,"button",3),g.NdJ("click",function(){return e.$implicit.action()}),g.TgZ(1,"mat-icon"),g._uU(2),g.qZA(),g.qZA()),2&t){var n=e.$implicit;g.Q6J("matTooltip",n.tooltip),g.xp6(2),g.Oqu(n.icon)}}function k(t,e){if(1&t&&(g.TgZ(0,"mat-toolbar-row"),g.YNc(1,R,3,2,"button",1),g.qZA()),2&t){var n=g.oxw();g.xp6(1),g.Q6J("ngForOf",n.moreButtons)}}var x=function(){var e=function(){function e(n,o,i,a,s,c){t(this,e),this.coreService=n,this.asset=o,this.authService=i,this.snack=a,this.route=s,this.router=c,this.user=new f.L("","",new Date,"","","",[]),this.hideOptions=!0,this.AllCardsSelected=!1,this.mainButtons=[{icon:"manage_accounts",tooltip:"show account options",action:this.viewProfile.bind(this)},{icon:"more_vert",tooltip:"display a menu with options for managing chats",action:this.viewOptions.bind(this)},{icon:"logout",tooltip:"Exit the App",action:this.logout.bind(this)}],this.moreButtons=[{icon:"done_outlined",tooltip:"Select Chats for Deletion",action:this.activateSelectFlag.bind(this)},{icon:"add_circle_outlined",tooltip:"create new Chat",action:this.createRoom.bind(this)},{icon:"delete_outlined",tooltip:"Delete all Selected Chats",action:this.deleteFlagged.bind(this)},{icon:"search",tooltip:"not implemented yet",action:this.createRoom.bind(this)},{icon:"contacts",tooltip:"view and edit all contacts",action:this.displayContacts.bind(this)}]}return n(e,[{key:"viewOptions",value:function(){this.hideOptions=!this.hideOptions}},{key:"activateSelectFlag",value:function(){this.AllCardsSelected=!this.AllCardsSelected,this.moreButtons[0].icon=this.AllCardsSelected?"done_outlined":"select_all"}},{key:"deleteFlagged",value:function(){}},{key:"viewProfile",value:function(){this.router.navigate(["../profile"],{relativeTo:this.route})}},{key:"createRoom",value:function(){this.router.navigate(["../contacts"],{relativeTo:this.route,state:{createRoom:!0}})}},{key:"displayContacts",value:function(){this.router.navigate(["../contacts"],{relativeTo:this.route})}},{key:"logout",value:function(){var t=this;this.snack.execute("Sure to close your session?","Confirm",{duration:2e3},function(){return t.authService.logOutRoutine()})}},{key:"ngOnInit",value:function(){var t=this;this.route.data.pipe((0,d.b)(function(){return console.log("\n\n\n\xbatapping data side\n\n\n\n\xba")}),(0,d.b)(console.log)).subscribe(function(e){t.user=e.loggedUser,t.user&&(t.user.photo=t.asset.buildAsset(t.user.photo))})}},{key:"ngOnDestroy",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(p.p),g.Y36(h.z),g.Y36(b.e),g.Y36(Z.f),g.Y36(c.gz),g.Y36(c.F0))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-side-toolbar"]],decls:8,vars:8,consts:[["mat-card-avatar","","alt","user profile avatar image",3,"src"],["mat-icon-button","",3,"matTooltip","click",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-icon-button","",3,"matTooltip","click"]],template:function(t,e){1&t&&(g.TgZ(0,"mat-toolbar"),g.TgZ(1,"mat-toolbar-row"),g._UZ(2,"img",0),g._uU(3),g.ALo(4,"titlecase"),g.ALo(5,"truncate"),g.YNc(6,_,3,2,"button",1),g.qZA(),g.YNc(7,k,2,1,"mat-toolbar-row",2),g.qZA()),2&t&&(g.xp6(2),g.Q6J("src",e.user.photo,g.LSH),g.xp6(1),g.hij(" ",g.lcZ(4,4,g.lcZ(5,6,e.user.username))," "),g.xp6(3),g.Q6J("ngForOf",e.mainButtons),g.xp6(1),g.Q6J("ngIf",!e.hideOptions))},directives:[A.Ye,A.rD,w.kc,s.sg,s.O5,y.lW,T.gM,C.Hw],pipes:[s.rS,S.W],styles:["mat-toolbar[_ngcontent-%COMP%]{width:300px;background:inherit}mat-toolbar[_ngcontent-%COMP%]   mat-toolbar-row[_ngcontent-%COMP%]{justify-content:space-between}"]}),e}(),q=i(7746),O=i(346),M=i(5384);function U(t,e){if(1&t&&(g.TgZ(0,"mat-icon",6),g._uU(1,"more_vert"),g.qZA()),2&t){g.oxw();var n=g.MAs(9);g.Q6J("matTooltip","show options for this chat")("matMenuTriggerFor",n)}}function Y(t,e){if(1&t){var n=g.EpF();g.TgZ(0,"mat-card"),g.TgZ(1,"mat-card-header"),g.TgZ(2,"img",1),g.NdJ("click",function(){var t=g.CHM(n).index;return g.oxw().onClickCardNameAndAvatar(t)}),g.qZA(),g.TgZ(3,"mat-card-title",2),g.NdJ("click",function(){var t=g.CHM(n).index;return g.oxw().onClickCardNameAndAvatar(t)}),g._uU(4),g.ALo(5,"truncate"),g.ALo(6,"titlecase"),g.qZA(),g.YNc(7,U,2,2,"mat-icon",3),g.TgZ(8,"mat-menu",null,4),g.TgZ(10,"button",5),g.NdJ("click",function(){var t=g.CHM(n).$implicit;return g.oxw().onDeleteRoom(t)}),g.TgZ(11,"mat-icon"),g._uU(12,"delete"),g.qZA(),g.TgZ(13,"span"),g._uU(14,"Delete"),g.qZA(),g.qZA(),g.TgZ(15,"button",5),g.NdJ("click",function(){var t=g.CHM(n).$implicit;return g.oxw().onEditRoom(t)}),g.TgZ(16,"mat-icon"),g._uU(17,"edit"),g.qZA(),g.TgZ(18,"span"),g._uU(19,"Edit"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&t){var o=e.$implicit,i=e.index;g.xp6(2),g.Q6J("matTooltip","click here to load chat")("src",o.roomPhoto,g.LSH),g.xp6(1),g.Q6J("matBadge",o.pending)("matBadgeHidden",!o.pending)("matTooltip","click here to load chat"),g.xp6(1),g.hij(" ",g.xi3(5,7,g.lcZ(6,10,o.roomName),17)," "),g.xp6(3),g.Q6J("ngIf",i>0)}}var J=function(){var e=function(){function e(n,o,i){t(this,e),this.asset=n,this.coreService=o,this.activatedRoute=i,this.loadedRooms=[],this.roomSub=new u.w,this.activeRoomSub=new u.w}return n(e,[{key:"ngOnInit",value:function(){var t=this;this.activatedRoute.data.subscribe(function(e){t.onReceiveRoomData(e.loadedRooms)}),this.coreService.loadedRoomsBehaviorSubject.pipe().subscribe(this.onReceiveRoomData.bind(this)),this.coreService.messageListStateSnapshotSubject.pipe().subscribe(function(e){return t.coreService.updateBadges(e,t.loadedRooms)})}},{key:"ngOnDestroy",value:function(){this.roomSub&&this.roomSub.unsubscribe(),this.activeRoomSub&&this.activeRoomSub.unsubscribe()}},{key:"onClickCardNameAndAvatar",value:function(t){var e=this;this.coreService.pickRoom(t).subscribe(function(t){e.coreService.emitJoinRoomEvent(t._id)})}},{key:"onDeleteRoom",value:function(t){alert("implement Delete Room")}},{key:"onEditRoom",value:function(t){alert("implement Edit Room")}},{key:"onReceiveRoomData",value:function(t){var e=this;this.loadedRooms=t,this.loadedRooms.forEach(function(t){return t.roomPhoto=e.asset.buildAsset(t.roomPhoto)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(h.z),g.Y36(p.p),g.Y36(c.gz))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-room-tile"]],decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["alt","profile image","mat-card-avatar","",3,"matTooltip","src","click"],["matBadgeSize","small","matBadgeOverlap","false","matBadgePosition","above after","matBadgeColor","primary",3,"matBadge","matBadgeHidden","matTooltip","click"],["aria-label","show options for this chat",3,"matTooltip","matMenuTriggerFor",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click"],["aria-label","show options for this chat",3,"matTooltip","matMenuTriggerFor"]],template:function(t,e){1&t&&(g.TgZ(0,"div"),g.YNc(1,Y,20,12,"mat-card",0),g.qZA()),2&t&&(g.xp6(1),g.Q6J("ngForOf",e.loadedRooms))},directives:[s.sg,w.a8,w.dk,w.kc,T.gM,w.n5,O.k,s.O5,M.VK,M.OP,C.Hw,M.p6],pipes:[S.W,s.rS],styles:["mat-icon[_ngcontent-%COMP%]{margin-left:auto}.mat-card-avatar[_ngcontent-%COMP%], mat-card-title[_ngcontent-%COMP%], mat-icon[_ngcontent-%COMP%]{cursor:pointer}"]}),e}(),I=i(1209),P=i(2684),N=i(9983);function Q(t,e){if(1&t){var n=g.EpF();g.TgZ(0,"mat-toolbar",1),g._UZ(1,"textarea",2,3),g._uU(3," | "),g.TgZ(4,"button",4),g.NdJ("click",function(){g.CHM(n);var t=g.MAs(2);return g.oxw().postMessage(t)}),g.TgZ(5,"mat-icon"),g._uU(6,"send"),g.qZA(),g.qZA(),g.qZA()}if(2&t){var o=g.MAs(2);g.xp6(1),g.Q6J("mat-autosize",!0)("matTextareaAutosize",!0)("matAutosizeMinRows",2)("matAutosizeMaxRows",3),g.xp6(3),g.Q6J("disabled",""===o.value)}}var B=function(){var e=function(){function e(n,o,i,a){t(this,e),this.activatedRoute=n,this.authService=o,this.msgService=i,this.coreService=a,this.activeRoomSub=new u.w,this.activeRoom="",this.displayBar=!0,this.loggedUserId=!0}return n(e,[{key:"ngOnInit",value:function(){var t=this;this.activatedRoute.data.subscribe(function(e){t.loggedUserId=e.loggedUser._id,t.displayBar=!!e.currentActiveRoom,t.activeRoom=t.displayBar?e.currentActiveRoom.id:null}),this.activeRoomSub=this.coreService.catchActiveRoom().subscribe(function(e){e&&(t.displayBar=!0,t.activeRoom=e._id)})}},{key:"postMessage",value:function(t){var e=new I.e(t.value,this.activeRoom,this.loggedUserId,0);t.value="",t.focus(),this.coreService.emitMessageEvent(e)}},{key:"ngOnChanges",value:function(){this.activeRoomSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(c.gz),g.Y36(b.e),g.Y36(P.e),g.Y36(p.p))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-bottom-toolbar"]],features:[g.TTD],decls:1,vars:1,consts:[["class","bottom-toolbar","color","primary",4,"ngIf"],["color","primary",1,"bottom-toolbar"],["placeholder","Text here...",2,"width","85%",3,"mat-autosize","matTextareaAutosize","matAutosizeMinRows","matAutosizeMaxRows"],["msgContentRef",""],["mat-icon-button","",3,"disabled","click"]],template:function(t,e){1&t&&g.YNc(0,Q,7,5,"mat-toolbar",0),2&t&&g.Q6J("ngIf",e.displayBar)},directives:[s.O5,A.Ye,N.D7,y.lW,C.Hw],styles:[".bottom-toolbar[_ngcontent-%COMP%]{position:sticky;bottom:0}textarea[_ngcontent-%COMP%]{outline-color:transparent}mat-toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto}"]}),e}(),F=i(5435),z=function(){var e=function(){function e(){t(this,e)}return n(e,[{key:"transform",value:function(t){return t.toLocaleString().replace("T","  ").split(":").slice(0,2).join(":")}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=g.Yjl({name:"datetime",type:e,pure:!0}),e}();function H(t,e){if(1&t&&(g.TgZ(0,"span"),g.TgZ(1,"mat-icon",4),g._uU(2),g.qZA(),g.qZA()),2&t){var n=g.oxw();g.xp6(1),g.Q6J("inline",!0),g.xp6(1),g.Oqu(0===n.data.state?"query_builder":1===n.data.state?"done":"done_all")}}var L=function(){var e=function(){function e(){t(this,e),this.data=new I.e("","","",0)}return n(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-msg-bubble"]],inputs:{data:"data"},decls:10,vars:5,consts:[[1,"width-align-bubble"],[1,"msg-content"],[1,"msg-footer"],[4,"ngIf"],[3,"inline"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"mat-card"),g.TgZ(2,"mat-card-content"),g.TgZ(3,"p",1),g._uU(4),g.qZA(),g.qZA(),g.TgZ(5,"mat-card-footer"),g.TgZ(6,"p",2),g._uU(7),g.ALo(8,"datetime"),g.YNc(9,H,3,2,"span",3),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t&&(g.xp6(4),g.Oqu(e.data.text),g.xp6(3),g.hij("sent at: ",g.lcZ(8,3,e.data.sent)," "),g.xp6(2),g.Q6J("ngIf",e.data.owner))},directives:[w.a8,w.dn,w.rt,s.O5,C.Hw],pipes:[z],styles:[".width-align-bubble[_ngcontent-%COMP%]{padding:4px}.msg-footer[_ngcontent-%COMP%]{padding-right:10px;max-width:35%;text-align:right;margin-left:auto;margin-bottom:1px;font-size:xx-small}.msg-content[_ngcontent-%COMP%]{font-size:small;word-wrap:break-word}"]}),e}(),D=i(4885),E=["msgTemplateRef"],j=function(t,e){return{"msg-left-container":t,"msg-right-container":e}};function $(t,e){if(1&t&&(g.TgZ(0,"div",4,5),g._UZ(2,"app-msg-bubble",6),g.qZA()),2&t){var n=e.$implicit,o=g.oxw(2);g.Q6J("ngClass",g.WLB(2,j,!o.setAlign(n.owner),o.setAlign(n.owner))),g.xp6(2),g.Q6J("data",n)}}function W(t,e){if(1&t&&(g.TgZ(0,"div"),g.YNc(1,$,3,5,"div",3),g.qZA()),2&t){var n=g.oxw();g.xp6(1),g.Q6J("ngForOf",n.currentConversationMessages)}}function X(t,e){1&t&&(g.TgZ(0,"div"),g.TgZ(1,"div",7),g.TgZ(2,"p"),g._uU(3," This Chat is empty... "),g.qZA(),g.qZA(),g.qZA())}function V(t,e){1&t&&(g.TgZ(0,"div",8),g._UZ(1,"mat-spinner",9),g.qZA())}var G=function(){var e=function(){function e(n,o){t(this,e),this.activatedRoute=n,this.coreService=o,this.messageInstances=void 0,this.currentConversationMessages=[],this.currentActiveRoom=void 0,this.listState=0,this.loggedUserId=void 0,this.sendSub=new u.w,this.msgSub=new u.w,this.scrollSub=new u.w,this.activeRoomSub=new u.w,this.listStateSub=new u.w}return n(e,[{key:"setAlign",value:function(t){return"boolean"==typeof t?t:this.loggedUserId===t}},{key:"ngOnInit",value:function(){var t=this;this.activatedRoute.data.subscribe(function(e){t.loggedUserId=e.loggedUser._id,t.listState=e.loadedRooms&&e.loadedRooms.length>0?2:1}),this.activeRoomSub=this.coreService.activeRoomBehaviorSubject.pipe((0,d.b)(function(e){t.listState=0,console.log("\n\n\nset list to zero\n\n\n"),t.currentActiveRoom=e})).subscribe(function(e){t.currentConversationMessages=t.coreService.readRoomMessages(null==e?void 0:e._id),t.currentConversationMessages.forEach(function(t){return t.register(t._id)}),t.listState=2,console.log("\n\n\nset list to two\n\n\n")},console.log),this.sendSub=this.coreService.messageSubject.pipe((0,F.h)(function(e){var n;return e.room===(null===(n=t.currentActiveRoom)||void 0===n?void 0:n._id)})).subscribe(function(e){t.currentConversationMessages.push(e)})}},{key:"ngAfterViewInit",value:function(){var t,e=this;this.scrollSub=null===(t=this.messageInstances)||void 0===t?void 0:t.changes.subscribe(function(){e.messageInstances&&e.messageInstances.last&&e.messageInstances.last.nativeElement.scrollIntoView({behavior:"smooth",block:"end"})})}},{key:"ngOnDestroy",value:function(){this.listStateSub.unsubscribe(),this.sendSub.unsubscribe(),this.msgSub.unsubscribe(),this.scrollSub.unsubscribe(),this.activeRoomSub&&this.activeRoomSub.unsubscribe()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(c.gz),g.Y36(p.p))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-msg-list"]],viewQuery:function(t,e){var n;(1&t&&g.Gf(E,5),2&t)&&(g.iGM(n=g.CRH())&&(e.messageInstances=n))},decls:4,vars:4,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],["id","spinner",4,"ngSwitchCase"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["msgTemplateRef",""],[3,"data"],[2,"height","100%"],["id","spinner"],["color","primary"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.YNc(1,W,2,1,"div",1),g.YNc(2,X,4,0,"div",1),g.YNc(3,V,2,0,"div",2),g.qZA()),2&t&&(g.Q6J("ngSwitch",e.listState),g.xp6(1),g.Q6J("ngSwitchCase",2),g.xp6(1),g.Q6J("ngSwitchCase",1),g.xp6(1),g.Q6J("ngSwitchCase",0))},directives:[s.RF,s.n9,s.sg,s.mk,L,D.$g],styles:[".msg-left-container[_ngcontent-%COMP%]{margin-right:auto;margin-bottom:4px;width:60%}.msg-right-container[_ngcontent-%COMP%]{margin-left:auto;margin-bottom:4px;width:60%}div[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:last-child{padding-bottom:70px}#spinner[_ngcontent-%COMP%]{height:200px;display:flex;align-items:center;justify-content:center}"]}),e}();function K(t,e){if(1&t){var n=g.EpF();g.TgZ(0,"button",9),g.NdJ("click",function(){return g.CHM(n),g.oxw(),g.MAs(2).toggle()}),g.TgZ(1,"mat-icon",10),g._uU(2,"menu"),g.qZA(),g.qZA()}}function tt(t,e){1&t&&(g.TgZ(0,"span"),g._uU(1,"MEAN Chat"),g.qZA())}function et(t,e){if(1&t&&(g.TgZ(0,"span"),g._UZ(1,"img",11),g.TgZ(2,"span",12),g._uU(3),g.ALo(4,"titlecase"),g.ALo(5,"truncate"),g.qZA(),g.qZA()),2&t){var n=g.oxw();g.xp6(1),g.Q6J("src",n.chatPhoto,g.LSH),g.xp6(2),g.hij(" ",g.lcZ(4,2,g.xi3(5,4,n.selectedChat,25)),"")}}function nt(t,e){1&t&&g._UZ(0,"app-msg-list")}function ot(t,e){if(1&t){var n=g.EpF();g.TgZ(0,"mat-card",13),g.TgZ(1,"mat-card-header"),g.TgZ(2,"mat-card-title"),g._uU(3),g.ALo(4,"titlecase"),g.qZA(),g.qZA(),g.TgZ(5,"mat-card-content"),g.TgZ(6,"p"),g._uU(7,"Before start chatting you must add some contacts to talk with."),g.qZA(),g.TgZ(8,"span"),g._uU(9,"you can start clicking here "),g.qZA(),g.TgZ(10,"span"),g.TgZ(11,"button",14),g.NdJ("click",function(){return g.CHM(n),g.oxw().addFirstContact()}),g.TgZ(12,"mat-icon"),g._uU(13,"contacts"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(14,"p"),g._uU(15,"And:"),g.qZA(),g.TgZ(16,"span"),g._uU(17,"When you finish, you can click the option chat: "),g.qZA(),g.TgZ(18,"span"),g.TgZ(19,"mat-icon"),g._uU(20,"chat"),g.qZA(),g.qZA(),g.TgZ(21,"span"),g._uU(22," and that's all"),g.qZA(),g.TgZ(23,"p"),g._uU(24,"You can also create groups by clicking the options"),g.qZA(),g.TgZ(25,"span"),g.TgZ(26,"mat-icon"),g._uU(27,"more_vert"),g.qZA(),g.qZA(),g.TgZ(28,"span"),g._uU(29,"and click the option"),g.qZA(),g.TgZ(30,"span"),g.TgZ(31,"mat-icon"),g._uU(32,"add_circle_outline"),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&t){var o=g.oxw();g.xp6(3),g.hij(" Hi ",g.lcZ(4,1,null==o.currentUser?null:o.currentUser.username)," ")}}var it,at,st=function(){var e=function(){function e(n,o,i,a,s){t(this,e),this.coreService=n,this.router=o,this.asset=i,this.activatedRoute=a,this.breakpointObserver=s,this.activeRoom=void 0,this.activeRoomSub=new u.w,this.currentUser=void 0,this.selectedChat="",this.chatPhoto="",this.emptyChat=!0,this.isHandset$=this.breakpointObserver.observe(r.u3.Handset).pipe((0,l.U)(function(t){return t.matches}),(0,m.d)())}return n(e,[{key:"ngOnInit",value:function(){var t=this;this.activatedRoute.data.pipe((0,d.b)(console.log)).subscribe(function(e){t.emptyChat=!(e.loadedRooms&&e.loadedRooms.length>0),t.currentUser=e.loggedUser,t.activeRoom=e.currentActiveRoom?e.currentActiveRoom:null,t.updateUiOnActiveRoomChange(t.activeRoom)},function(t){console.log(t)},function(){console.log("\n\ncomplete subscription on home\n\n")}),this.activeRoomSub=this.coreService.catchActiveRoom().pipe().subscribe(function(e){e&&(t.activeRoom=e),t.updateUiOnActiveRoomChange(e)})}},{key:"ngOnDestroy",value:function(){this.activeRoomSub.unsubscribe()}},{key:"updateUiOnActiveRoomChange",value:function(t){t?(this.emptyChat=!1,this.selectedChat=null==t?void 0:t.roomName,this.chatPhoto=this.asset.buildAsset(null==t?void 0:t.roomPhoto)):this.emptyChat=!0}},{key:"addFirstContact",value:function(){return this.router.navigate(["session",this.currentUser._id,"contacts"])}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(p.p),g.Y36(c.F0),g.Y36(h.z),g.Y36(c.gz),g.Y36(r.Yg))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-home"]],decls:21,vars:16,consts:[[1,"sidenav-container"],["fixedInViewport","",1,"sidenav",3,"mode","opened"],["drawer",""],["color","primary",1,"mat-top-toolbar"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click",4,"ngIf"],[4,"ngIf"],[1,"msg-list"],[4,"ngIf","ngIfElse"],["emptyChatCard",""],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["aria-label","Side nav toggle icon"],["mat-card-avatar","",3,"src"],[2,"margin-left","5px"],[2,"width","50%","margin","80px auto"],["mat-icon-button","",3,"click"]],template:function(t,e){if(1&t&&(g.TgZ(0,"mat-sidenav-container",0),g.TgZ(1,"mat-sidenav",1,2),g.ALo(3,"async"),g.ALo(4,"async"),g.ALo(5,"async"),g._UZ(6,"app-side-toolbar"),g.TgZ(7,"mat-nav-list"),g._UZ(8,"app-room-tile"),g.qZA(),g.qZA(),g.TgZ(9,"mat-sidenav-content"),g.TgZ(10,"mat-toolbar",3),g.TgZ(11,"mat-toolbar-row"),g.YNc(12,K,3,0,"button",4),g.ALo(13,"async"),g.YNc(14,tt,2,0,"span",5),g.YNc(15,et,6,7,"span",5),g.qZA(),g.qZA(),g.TgZ(16,"div",6),g.YNc(17,nt,1,0,"app-msg-list",7),g.qZA(),g._UZ(18,"app-bottom-toolbar"),g.qZA(),g.qZA(),g.YNc(19,ot,33,3,"ng-template",null,8,g.W1O)),2&t){var n=g.MAs(20);g.xp6(1),g.Q6J("mode",g.lcZ(4,10,e.isHandset$)?"over":"side")("opened",!1===g.lcZ(5,12,e.isHandset$)),g.uIk("role",g.lcZ(3,8,e.isHandset$)?"dialog":"navigation"),g.xp6(11),g.Q6J("ngIf",g.lcZ(13,14,e.isHandset$)),g.xp6(2),g.Q6J("ngIf",e.emptyChat),g.xp6(1),g.Q6J("ngIf",!e.emptyChat),g.xp6(2),g.Q6J("ngIf",!e.emptyChat)("ngIfElse",n)}},directives:[v.TM,v.JX,x,q.Hk,J,v.Rh,A.Ye,A.rD,s.O5,B,y.lW,C.Hw,w.kc,G,w.a8,w.dk,w.n5,w.dn],pipes:[s.Ov,s.rS,S.W],styles:[".sidenav-container[_ngcontent-%COMP%]{height:100%}.sidenav[_ngcontent-%COMP%]{width:300px}.sidenav[_ngcontent-%COMP%]   .mat-toolbar[_ngcontent-%COMP%]{background:inherit}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1}.bottom-toolbar[_ngcontent-%COMP%]{width:100%;position:sticky;bottom:0;z-index:1}.msg-list[_ngcontent-%COMP%]{min-height:800px}.mat-top-toolbar[_ngcontent-%COMP%]{z-index:1;position:sticky;top:0}"]}),e}(),ct=i(6201),rt=i(6634),ut=i(5257),lt=[{path:"",component:st,resolve:{loadedRooms:(it=function(){function e(n){t(this,e),this.coreService=n}return n(e,[{key:"resolve",value:function(t,e){var n=this;return this.coreService.loadedRoomsBehaviorSubject.pipe((0,ut.q)(1),(0,d.b)(function(t){0===t.length&&n.coreService.loadRoomsFromUser()}))}}]),e}(),it.\u0275fac=function(t){return new(t||it)(g.LFG(p.p))},it.\u0275prov=g.Yz7({token:it,factory:it.\u0275fac,providedIn:"root"}),it),loggedUser:ct.T,currentActiveRoom:rt.e}}],mt=function(){var e=function e(){t(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[s.ez,c.Bz.forChild(lt)],c.Bz]}),e}(),dt=((at=function e(){t(this,e)}).\u0275fac=function(t){return new(t||at)},at.\u0275mod=g.oAB({type:at}),at.\u0275inj=g.cJS({imports:[[a.m,mt]]}),at)}}])}();